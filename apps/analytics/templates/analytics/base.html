{% extends "base.html" %}
{% load static %}

{% block title %}Аналитика{% endblock %}

{% block extra_css %}
{{ block.super }}
<link rel="stylesheet" href="{% static 'analytics/css/analytics.css' %}">
<style>
.chart-container {
    position: relative;
    height: 500px;
    margin-bottom: 2rem;
    overflow: hidden;
}

.chart-container canvas {
    max-height: 100% !important;
}

.chart-loading {
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100%;
    background-color: rgba(255, 255, 255, 0.8);
}

.chart-export-btn {
    position: absolute;
    top: 10px;
    right: 10px;
    z-index: 1000;
}

.analytics-filter-form {
    background: #f8f9fa;
    padding: 1rem;
    border-radius: 0.375rem;
    margin-bottom: 2rem;
}

.metrics-card {
    transition: transform 0.2s;
}

.metrics-card:hover {
    transform: translateY(-2px);
}

@media (max-width: 768px) {
    .chart-container {
        height: 400px;
    }

    .chart-container canvas {
        max-height: 350px !important;
    }
}

@media (max-width: 576px) {
    .chart-container {
        height: 350px;
        padding: 1rem;
    }

    .chart-container canvas {
        max-height: 300px !important;
    }
}
</style>
{% endblock %}

{% block extra_js %}
{{ block.super }}
<!-- Chart.js -->
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns@3.0.0/dist/chartjs-adapter-date-fns.bundle.min.js"></script>

<!-- Analytics Chart Utils -->
<script src="{% static 'analytics/js/chart-utils.js' %}"></script>
<script src="{% static 'analytics/js/analytics-charts.js' %}"></script>

{% block chart_data %}
<!-- Chart data will be injected here by child templates -->
{% endblock %}

{% block analytics_js %}
<!-- Additional analytics JavaScript -->
{% endblock %}
{% endblock %}

{% block content %}
<div class="analytics-container">
    {% block breadcrumbs %}
    <nav aria-label="breadcrumb" class="mb-3">
        <ol class="breadcrumb">
            <li class="breadcrumb-item">
                <a href="{% url 'core:dashboard' %}">
                    <i class="bi bi-house"></i> Главная
                </a>
            </li>
            <li class="breadcrumb-item">
                <a href="{% url 'analytics:dashboard' %}">
                    <i class="bi bi-bar-chart"></i> Аналитика
                </a>
            </li>
            {% block breadcrumb_items %}
            {% endblock %}
        </ol>
    </nav>
    {% endblock %}

    {% block analytics_header %}
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h1 class="h3 mb-0">{% block analytics_title %}Аналитика{% endblock %}</h1>
        <div class="btn-group" role="group">
            {% block analytics_actions %}
            {% endblock %}
        </div>
    </div>
    {% endblock %}

    {% block analytics_filters %}
    <!-- Filters will be included by child templates -->
    {% endblock %}

    {% block analytics_content %}
    {% endblock %}
</div>
{% endblock %}
