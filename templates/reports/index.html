{% extends 'base.html' %}

{% block title %}Отчеты{% endblock %}

{% block content %}
<div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
    <h1 class="h2">Отчеты и экспорт данных</h1>
</div>

<!-- Кастомный экспорт -->
<div class="card mb-4">
    <div class="card-header bg-info text-white">
        <h5 class="mb-0"><i class="bi bi-sliders"></i> Кастомный экспорт</h5>
    </div>
    <div class="card-body">
        <p>Создайте экспорт с выбором полей и фильтров по вашим требованиям</p>
        <a href="{% url 'reports:custom_export' %}" class="btn btn-info">
            <i class="bi bi-gear"></i> Создать кастомный экспорт
        </a>
        
        {% if recent_templates %}
        <hr>
        <h6>Последние использованные шаблоны:</h6>
        <ul class="list-group">
            {% for template in recent_templates %}
            <li class="list-group-item d-flex justify-content-between align-items-center">
                <span>
                    <i class="bi bi-bookmark"></i> {{ template.name }}
                    <small class="text-muted">({{ template.get_data_source_display }})</small>
                </span>
                <a href="{% url 'reports:custom_export' %}?template={{ template.id }}" class="btn btn-sm btn-outline-primary">
                    Использовать
                </a>
            </li>
            {% endfor %}
        </ul>
        {% endif %}
    </div>
</div>

<!-- Готовые экспорты -->
<h4 class="mb-3">Готовые экспорты</h4>
<div class="row">
    <div class="col-md-6">
        <div class="card mb-4">
            <div class="card-header bg-primary text-white">
                <h5 class="mb-0"><i class="bi bi-file-earmark-spreadsheet"></i> Экспорт полисов</h5>
            </div>
            <div class="card-body">
                <p>Экспортировать все полисы в формате Excel со всей информацией:</p>
                <ul>
                    <li>Номера полисов и ДФА</li>
                    <li>Клиенты и страховщики</li>
                    <li>Периоды действия</li>
                    <li>Финансовая информация</li>
                    <li>Статусы</li>
                </ul>
                <a href="{% url 'reports:export_policies' %}" class="btn btn-primary">
                    <i class="bi bi-download"></i> Скачать Excel
                </a>
            </div>
        </div>
    </div>

    <div class="col-md-6">
        <div class="card mb-4">
            <div class="card-header bg-success text-white">
                <h5 class="mb-0"><i class="bi bi-calendar-check"></i> Экспорт графика платежей</h5>
            </div>
            <div class="card-body">
                <p>Экспортировать график платежей в формате Excel:</p>
                <ul>
                    <li>Все платежи по всем полисам</li>
                    <li>Даты и суммы</li>
                    <li>Комиссии (КВ)</li>
                    <li>Статусы оплаты</li>
                    <li>Согласования со СК</li>
                </ul>
                <a href="{% url 'reports:export_payments' %}" class="btn btn-success">
                    <i class="bi bi-download"></i> Скачать Excel
                </a>
            </div>
        </div>
    </div>

    <div class="col-md-6">
        <div class="card mb-4">
            <div class="card-header bg-warning text-dark">
                <h5 class="mb-0"><i class="bi bi-cloud-upload"></i> Четверговый отчет</h5>
            </div>
            <div class="card-body">
                <p>Экспортировать полисы, которые НЕ подгружены:</p>
                <ul>
                    <li>Все полисы со статусом "Полис НЕ подгружен"</li>
                    <li>Номера полисов и ДФА</li>
                    <li>Клиенты и страховщики</li>
                    <li>Периоды действия</li>
                    <li>Финансовая информация</li>
                </ul>
                <a href="{% url 'reports:export_thursday_report' %}" class="btn btn-warning">
                    <i class="bi bi-download"></i> Скачать Excel
                </a>
            </div>
        </div>
    </div>
</div>
{% endblock %}
